<!DOCTYPE html> 
<!-- layout.html -->

<!-- 
layout:decorate="~{layout/layout}"  란?
- 기본 레이아웃을 layout/layout.html 으로 선언
- 버전마다 선언방법이 다름 아래 참조.
- layout:decorate thymeleaf 3.* ver (이거 사용함)
- layout:decorator thymeleaf 2.* ver
 <th:block layout:fragment="content">
- 각 파일 마다, 위 코드 다음부터 작성한 내용들이 default_layout.html 의 content 부분에 위치함
-->
<html lang="ko" 
        xmlns:th="http://www.thymeleaf.org"
        xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
        layout:decorate="~{/layout/layout}">
	<head>
        <meta charset="UTF-8"/>
        <style>
			.account-settings .user-profile {
			    margin: 0 0 1rem 0;
			    padding-bottom: 1rem;
			    text-align: center;
			}
			.account-settings .user-profile .user-avatar {
			    margin: 0 0 1rem 0;
			}
			.account-settings .user-profile .user-avatar img {
			    width: 90px;
			    height: 90px;
			    -webkit-border-radius: 100px;
			    -moz-border-radius: 100px;
			    border-radius: 100px;
			}
			.account-settings .user-profile h5.user-name {
			    margin: 0 0 0.5rem 0;
			}
			.account-settings .user-profile h6.user-email {
			    margin: 0;
			    font-size: 0.8rem;
			    font-weight: 400;
			    color: #9fa8b9;
			}
			.account-settings .about {
			    margin: 2rem 0 0 0;
			    text-align: center;
			}
			.account-settings .about h5 {
			    margin: 0 0 15px 0;
			    color: #007ae1;
			}
			.account-settings .about p {
			    font-size: 0.825rem;
			}
			.form-control {
			    border: 1px solid #cfd1d8;
			    -webkit-border-radius: 2px;
			    -moz-border-radius: 2px;
			    border-radius: 2px;
			    font-size: .825rem;
			    background: #ffffff;
			    color: #2e323c;
			}
			
			.card {
			    background: #ffffff;
			    -webkit-border-radius: 5px;
			    -moz-border-radius: 5px;
			    border-radius: 5px;
			    border: 0;
			    margin-bottom: 1rem;
			}
        </style>
	</head>      
	<th:block layout:fragment="content">
		<!-- Contact section-->
		    <section class="bg-light py-5">
			<form id="updateFrm"	method="POST"	 action="/member/updateMember">
				<input type="hidden"	name="memberNo"	th:value="${memberInfo.memberNo}"	>
				<div class="container">
					<div class="row gutters">
						<div class="col-xl-3 col-lg-3 col-md-12 col-sm-12 col-12">
							<div class="card h-100">
								<div class="card-body">
									<div class="account-settings">
										<div class="user-profile">
											<div class="user-avatar">
												<img th:src="@{/images/carvroong2.png}" alt="Maxwell Admin">
											</div>
											<h5 class="user-name" th:text="${memberInfo.memberId}"></h5>
											<h6 class="user-email" th:text="${memberInfo.memberEmail}"></h6>											
										</div>
										<!--
										<div class="about">
											<h5>About</h5>
											<p>I'm Pikachu. I hate Ash... Lol</p>
										</div>
										-->
									</div>
								</div>
							</div>
						</div>
						<div class="col-xl-9 col-lg-9 col-md-12 col-sm-12 col-12">
							<div class="card h-100">
								<div class="card-body">
									<div class="row gutters">
										<div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12">
											<h6 class="mb-2 text-primary">Personal Details</h6>
										</div>
										<div class="col-xl-6 col-lg-6 col-md-6 col-sm-6 col-12">
											<div class="form-group">
												<label for="memberId">Id</label>
												<input type="text" class="form-control" id="memberId" name="memberId"	th:value="${memberInfo.memberId}"	 readonly placeholder="Enter full id">
											</div>
										</div>
										<div class="col-xl-6 col-lg-6 col-md-6 col-sm-6 col-12">
											<div class="form-group">
												<label for="memberName">Name</label>
												<input type="text" class="form-control" id="memberName" name="memberName"	th:value="${memberInfo.memberName}"	readonly 	placeholder="Enter full name">
											</div>
										</div>
										<div class="col-xl-6 col-lg-6 col-md-6 col-sm-6 col-12">
											<div class="form-group">
												<label for="control">Email</label>
												<input type="email" class="form-control" id="memberEmail" name="memberEmail"	th:value="${memberInfo.memberEmail}"	placeholder="Enter email">
											</div>
										</div>
									</div>
									<div class="row gutters">
										<div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12">
											<h6 class="mt-3 mb-2 text-primary">Details</h6>
										</div>
										<div class="col-xl-6 col-lg-6 col-md-6 col-sm-6 col-12">
											<div class="form-group">
												<label for="memberMobile">Mobile</label>
												<input type="text" class="form-control" id="memberMobile" name="memberMobile"	th:value="${memberInfo.memberMobile}"	placeholder="Enter mobile number">
											</div>
										</div>
										<div class="col-xl-6 col-lg-6 col-md-6 col-sm-6 col-12">
											<div class="form-group">
												<label for="memberBirth">Birth</label>
												<input type="text" class="form-control" id="memberBirth" name="memberBirth"	th:value="${memberInfo.memberBirth}"	 placeholder="Enter birth">
											</div>
										</div>
										<div class="col-xl-6 col-lg-6 col-md-6 col-sm-6 col-12">
											<div class="form-group">
												<label for="memberLicense">License</label>
												<input type="text" class="form-control" id="memberLicense" name="memberLicense"	th:value="${memberInfo.memberLicense}"		placeholder="Enter driver license number">
											</div>
										</div>
										<!--
										<div class="col-xl-6 col-lg-6 col-md-6 col-sm-6 col-12">
											<div class="form-group">
												<label for="">기타</label>
												<input type="text" class="form-control" placeholder="Optional">
											</div>
										</div>
										-->
									<div class="row gutters">
										<div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12">
											<br/>
											<div class="text-right">
												<button type="button" id="btnMyPage"  class="btn btn-secondary">취소</button>
												<button type="button" id="btnUpdate" 	class="btn btn-primary">수정하기</button>
											</div>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
		    </form>
		    </section>
		<script>
        
	          /**
	         * 이메일 패턴 체크
	         *
	         * @return boolean
	         */
			function isValidEmail(Email) {
			
	    		var EMAIL_PATTERN = /^([0-9a-zA-Z_\.-]+)@([0-9a-zA-Z_-]+)(\.[0-9a-zA-Z_-]+){1,2}/;
	            
	            Email = $.trim((Email));
	            
	            if (Email.match(EMAIL_PATTERN) == null) {
	                return false;
	            } else {
	                return true;
	            }
	        }
	
	        /**------------------------------------------------------------------
	         * 전화번호 포맷 처리
	         */
	        function fncSetPhoneFormat(s) {
	            return String(s).replace(/[^0-9]/g, "").replace(/^(?:82|0)(1(0|1|6|7|8|9))(\d{3,4})(\d{4})(.*)$/, "0$1-$3-$4");
	        }
	
	        /**------------------------------------------------------------------
	         * 전화번호 유효성 검사
	         */
	        function fncIsValidPhoneNumber(s) {
	            return /^(82|0)1(0|1|6|7|8|9)\d{3,4}\d{4}/.test(String(s).replace(/[^0-9]/g, ""));
	        }
        
			/*비밀번호 변경페이지 이동*/
			$("#btnMyPage").click(function(){		
				location.href="/member/myPage";
			});

			$("#btnUpdate").click(function(){
				
				let emailValue = $("#memberEmail").val();
				
				if ($.trim(emailValue) == ""){
               		Swal.fire({
                  		icon: "warning", // Alert 타입 
                       	title: "이메일을 입력해주세요.", // Alert 제목 
               		});         		
               		$("#memberEmail").focus();			
					return false;
				}

				if (!isValidEmail($.trim(emailValue))) {
       				Swal.fire({
                  		icon: "warning", // Alert 타입 
                       	title: "이메일 형식이 아닙니다.", // Alert 제목 
               		});         					
               		$("#memberEmail").focus();
					return false;
            	}

				let mobileValue = $("#memberMobile").val();
	            
	            // 휴대폰을 입력안하면 경고문구 표시
	            if ( $.trim(mobileValue) == ""){
        			$("#memberMobile").val("");
           			Swal.fire({
                  		icon: "warning", // Alert 타입 
                       	title: "휴대폰번호를 입력해주세요.", // Alert 제목 
               		});        
               		$("#memberMobile").focus();
	                return false;                
	            }
	
	            // 휴대폰 형식이 안맞으면 경고문구 표시
	            if (mobileValue.replace(/[^0-9]/g, "").length < 10) {
                	$("#memberMobile").val("");
               		Swal.fire({
                  		icon: "warning", // Alert 타입 
                       	title: "휴대폰 형식이 맞지 않습니다.", // Alert 제목 
               		});      
               		$("#memberMobile").focus();
	                return false;
	            }
	            
		    	Swal.fire({
   					title: '회원정보를 변경 하시겠습니까?',
			   		//text: '다시 되돌릴 수 없습니다. 신중하세요.',
			   		icon: 'warning',
			   		showCancelButton: true, // cancel버튼 보이기. 기본은 원래 없음
			   		confirmButtonColor: '#3085d6', // confrim 버튼 색깔 지정
			  		cancelButtonColor: '#d33', // cancel 버튼 색깔 지정
			  		confirmButtonText: '확인', // confirm 버튼 텍스트 지정
				   	cancelButtonText: '취소', // cancel 버튼 텍스트 지정
				}).then(function(result){
					if(result.isConfirmed == true){		
                    	$("#updateFrm").submit();
					}
				});		

             });
	             
		</script>
	</th:block>
</html>
